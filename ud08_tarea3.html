<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UD08 – Tarea 3 – RAID 1 por Software</title>

    <style>
        body {
            margin: 0;
            background: #0d0d0d;
            color: #00ff88;
            font-family: 'Consolas', 'Courier New', monospace;
        }

        header {
            padding: 30px 0;
            text-align: center;
            font-size: 34px;
            font-weight: bold;
            background: black;
            border-bottom: 2px solid #00ff88;
            text-shadow: 0 0 8px #00ff88;
        }

        .contenedor {
            width: 90%;
            max-width: 900px;
            margin: 40px auto;
        }

        h2 {
            border-left: 6px solid #00ff88;
            padding-left: 12px;
            margin-top: 40px;
            text-shadow: 0 0 4px #00ff88;
        }

        p {
            line-height: 1.6;
        }

        code {
            color: #b6ffda;
        }

        ul {
            margin-top: 10px;
            line-height: 1.7;
        }

        .paso {
            background: rgba(0,255,80,0.06);
            border: 1px solid #0aff66;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 0 12px rgba(0,255,120,0.15);
        }

        img {
            width: 100%;
            border: 1px solid #00ff88;
            border-radius: 6px;
            margin-top: 12px;
        }

        .pie {
            font-size: 14px;
            opacity: 0.85;
            margin-top: 6px;
        }
    </style>
</head>

<body>

<header>UD08 – Tarea 3: RAID 1 por Software con mdadm</header>

<div class="contenedor">

    <h2>Objetivo de la practica</h2>

    <p>
        El objetivo es crear un <strong>RAID 1 (mirror)</strong> por software en Linux utilizando
        <code>mdadm</code>, con dos discos adicionales. El RAID se montara en
        <code>/srv/datosReflejados</code> y debe quedar <strong>configurado para montarse automaticamente</strong>
        en cada arranque del sistema.
    </p>

    <!-- CAPTURA 1.0 -->
    <div class="paso">
        <h3>1.0 – Añadir discos virtuales en Proxmox</h3>
        <p>
            Se agregan dos discos adicionales de <strong>10GB</strong> a la maquina virtual desde Proxmox.
            Estos discos simulan discos fisicos independientes y seran los dispositivos usados
            para construir el RAID 1.
        </p>
        <ul>
            <li>Se confirma que existen <strong>dos discos nuevos</strong> aparte del disco del sistema.</li>
            <li>El tamaño de ambos discos es el mismo para evitar desbalanceo.</li>
        </ul>
        <img src="media/1.O.PNG">
        <p class="pie">Captura 1.0: Discos de 10GB añadidos a la VM desde Proxmox.</p>
    </div>

    <!-- CAPTURA 1.1 -->
    <div class="paso">
        <h3>1.1 – Deteccion de discos en Linux (lsblk)</h3>
        <p>
            Desde Linux se verifica que el sistema detecta correctamente los nuevos discos mediante
            <code>lsblk</code>. En este punto deben aparecer como dispositivos sin particiones (por ejemplo
            <code>/dev/sdb</code> y <code>/dev/sdc</code>), sin punto de montaje.
        </p>
        <ul>
            <li>Comprobacion de nombres reales de dispositivos (sdb/sdc).</li>
            <li>Confirmacion de tamaño y estado inicial (sin particiones montadas).</li>
        </ul>
        <img src="media/1.1.PNG">
        <p class="pie">Captura 1.1: Verificacion de los discos detectados con lsblk.</p>
    </div>

    <!-- CAPTURA 1.2 -->
    <div class="paso">
        <h3>1.2 – Verificacion del estado inicial (fdisk -l)</h3>
        <p>
            Se utiliza <code>fdisk -l</code> para obtener informacion detallada de los discos. Se comprueba que
            los discos adicionales no contienen particiones previas y estan disponibles para ser particionados.
        </p>
        <ul>
            <li>Confirmacion de capacidad exacta en GiB y sectores.</li>
            <li>Verificacion de que no hay particiones existentes en los discos destinados al RAID.</li>
        </ul>
        <img src="media/1.2.PNG">
        <p class="pie">Captura 1.2: Estado inicial de los discos antes del particionado.</p>
    </div>

    <!-- CAPTURA 1.3 -->
    <div class="paso">
        <h3>1.3 – Particionado y tipo Linux RAID</h3>
        <p>
            Se crea una particion en cada disco (por ejemplo <code>/dev/sdb1</code> y <code>/dev/sdc1</code>)
            ocupando todo el espacio disponible. Posteriormente se establece el tipo de particion
            <strong>Linux raid autodetect</strong> (codigo <code>fd</code>), dejando ambas particiones listas para
            ser gestionadas por <code>mdadm</code>.
        </p>
        <ul>
            <li>Creacion de particion primaria 1 en cada disco.</li>
            <li>Tipo de particion configurado como RAID (fd).</li>
            <li>Se verifica que aparecen <code>sdb1</code> y <code>sdc1</code>.</li>
        </ul>
        <img src="media/1.3.PNG">
        <p class="pie">Captura 1.3: Particiones creadas y configuradas para RAID en ambos discos.</p>
    </div>

    <!-- CAPTURA 1.4 -->
    <div class="paso">
        <h3>1.4 – Creacion del RAID 1 con mdadm y comprobacion [UU]</h3>
        <p>
            Se crea el RAID 1 mediante <code>mdadm</code> generando el dispositivo <code>/dev/md1</code>.
            Se comprueba el estado con <code>cat /proc/mdstat</code>. El indicador <strong>[UU]</strong> confirma
            que los dos discos del array estan operativos. Si aparece sincronizacion (resync), se espera
            a que termine antes de continuar.
        </p>
        <ul>
            <li>Creacion del array: <code>/dev/md1</code> en nivel RAID 1.</li>
            <li>Verificacion del estado del array y finalizacion de sincronizacion.</li>
            <li>[UU] = ambos discos correctos dentro del RAID.</li>
        </ul>
        <img src="media/1.4.PNG">
        <p class="pie">Captura 1.4: RAID 1 creado en /dev/md1 y estado correcto [UU].</p>
    </div>

    <!-- CAPTURA 1.5 -->
    <div class="paso">
        <h3>1.5 – Formateo del dispositivo RAID (mkfs.ext4)</h3>
        <p>
            Una vez creado el array, se genera un sistema de archivos sobre <code>/dev/md1</code> con
            <code>mkfs.ext4</code>. Posteriormente se verifica con <code>lsblk -f</code> que el dispositivo RAID
            tiene tipo <strong>ext4</strong> y un UUID asignado.
        </p>
        <ul>
            <li>Creacion de ext4 en <code>/dev/md1</code>.</li>
            <li>Comprobacion del tipo de sistema de archivos y UUID mediante <code>lsblk -f</code>.</li>
        </ul>
        <img src="media/1.5.PNG">
        <p class="pie">Captura 1.5: Sistema de archivos ext4 creado sobre /dev/md1.</p>
    </div>

    <!-- CAPTURA 1.6 -->
    <div class="paso">
        <h3>1.6 – Montaje manual en /srv/datosReflejados</h3>
        <p>
            Se crea el directorio de montaje <code>/srv/datosReflejados</code> y se monta el RAID manualmente.
            La orden <code>df -h</code> confirma que <code>/dev/md1</code> queda montado en la ruta requerida.
        </p>
        <ul>
            <li>Creacion del punto de montaje: <code>/srv/datosReflejados</code>.</li>
            <li>Montaje manual: <code>mount /dev/md1 /srv/datosReflejados</code>.</li>
            <li>Verificacion del montaje con <code>df -h</code>.</li>
        </ul>
        <img src="media/1.6.PNG">
        <p class="pie">Captura 1.6: RAID montado correctamente en /srv/datosReflejados.</p>
    </div>

    <!-- CAPTURA 1.7 -->
    <div class="paso">
        <h3>1.7 – Persistencia: mdadm.conf, initramfs y fstab</h3>
        <p>
            Para que el RAID se reconstruya y se monte automaticamente en el arranque, se guarda la definicion
            del array en <code>/etc/mdadm/mdadm.conf</code>, se actualiza el initramfs con
            <code>update-initramfs -u</code> y se añade una entrada en <code>/etc/fstab</code> usando el UUID
            del sistema de archivos de <code>/dev/md1</code>.
        </p>
        <ul>
            <li>Registro del array en <code>/etc/mdadm/mdadm.conf</code>.</li>
            <li>Actualizacion de initramfs para detectar el RAID al arrancar.</li>
            <li>Entrada en <code>/etc/fstab</code> con UUID para montaje automatico en <code>/srv/datosReflejados</code>.</li>
        </ul>
        <img src="media/1.7.PNG">
        <p class="pie">Captura 1.7: Configuracion aplicada para montaje automatico tras reinicio.</p>
    </div>

    <!-- CAPTURA 1.8 -->
    <div class="paso">
        <h3>1.8 – Verificacion tras reinicio</h3>
        <p>
            Se reinicia el sistema y se comprueba que el volumen RAID se monta automaticamente. Mediante
            <code>df -h</code> se confirma que <code>/dev/md1</code> aparece montado en
            <code>/srv/datosReflejados</code> sin necesidad de intervencion manual.
        </p>
        <ul>
            <li>Reinicio del sistema para validar persistencia.</li>
            <li>Comprobacion de montaje automatico en la ruta requerida.</li>
        </ul>
        <img src="media/1.8.PNG">
        <p class="pie">Captura 1.8: Verificacion final de montaje automatico tras reinicio.</p>
    </div>

    <h2>Conclusion</h2>

    <p>
        Se ha configurado correctamente un RAID 1 por software con <code>mdadm</code> usando dos discos
        adicionales. El dispositivo <code>/dev/md1</code> se ha formateado en ext4, montado en
        <code>/srv/datosReflejados</code> y configurado para montarse automaticamente tras reiniciar,
        cumpliendo los requisitos del ejercicio.
    </p>

</div>

</body>
</html>
